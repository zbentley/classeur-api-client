<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<title>classeur-api-client Source: classeur-api-client.js</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	<link type="text/css" rel="stylesheet" href="styles/site.united.css">

</head>

<body>

<div class="navbar navbar-default navbar-fixed-top navbar-inverse">
<div class="container">
	<div class="navbar-header">
		<a class="navbar-brand" href="index.html">classeur-api-client</a>
		<button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#topNavigation">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
        </button>
	</div>
	<div class="navbar-collapse collapse" id="topNavigation">
		<ul class="nav navbar-nav">
			
			<li class="dropdown">
				<a href="modules.list.html" class="dropdown-toggle" data-toggle="dropdown">Modules<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="module-classeur-api-client.html">classeur-api-client</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="module-classeur-api-client-ClasseurClient.html">classeur-api-client~ClasseurClient</a></li>
				</ul>
			</li>
			
		</ul>
		<div class="col-sm-3 col-md-3">
            <form class="navbar-form" role="search">
                <div class="input-group">
                    <input type="text" class="form-control" placeholder="Search" name="q" id="search-input">
                    <div class="input-group-btn">
                        <button class="btn btn-default" id="search-submit"><i class="glyphicon glyphicon-search"></i></button>
                    </div>
                </div>
            </form>
        </div>
	</div>

</div>
</div>


<div class="container" id="toc-content">
<div class="row">

	
	<div class="col-md-12">
	
		<div id="main">
			

		<h1 class="page-title">Source: classeur-api-client.js</h1>
    
<section>
    <article>
        <pre
            class="sunlight-highlight-javascript linenums">'use strict';
/**
* Node.js client for the REST API of [Classeur](http://classeur.io/)
*
* **This is alpha software:** this is the first major release of this client library. While I've done my best to write thorough unit and integration tests, there may be bugs, and the API is subject to change in future versions.
 * @example &lt;caption>Installation&lt;/caption>
 * npm install classeur-api-client
 * @example &lt;caption>Usage&lt;/caption>
 * const ClasseurClient = require('classeur-api-client');
 *
 * const myClient = new ClasseurClient({ userId: "my id", apiKey: "my key" });
 *
 * myClient.getFile("some file id", function(error, result) {
 *     console.log(`Got a file called ${result.name}`);
 *     console.log(`...and some markdown: ${result.content.text}`);
 * });
 * @see The [ClasseurClient]{@link module:classeur-api-client~ClasseurClient} class for API usage information.
 * @see The [README](index.html) for an overview and more usage examples.
 * @see The [source code]{@link https://github.com/zbentley/classeur-api-client} on GitHub.
 * @module classeur-api-client
 */
const _ = require('lodash'),
    async = require('async'),
    RestClient = require('node-rest-client').Client,
    functionUtils = require('./function-utils');

function query(path, args, cb) {
    args.headers = {
        'x-agent-info': 'github.com/zbentley/classeur-api-client'
    };

    let req = this.RestClient.get(this.root + path, args, function(data, response) {
        if ( response.statusCode == 200 ) {
            cb(null, JSON.parse(data));
        } else {
            cb(`Got an error (${response.statusCode}): ${response.statusMessage}`, null);
        }
    });

    req.on('requestTimeout',function(req){
        req.abort();
        cb('request expired', null);
    });

    req.on('responseTimeout', _.partial(cb, 'request timed out', null));
    req.on('error',  _.partialRight(cb, null));
}

function multiQuery(type, wantArray, Array, cb) {
    const self = this;

    async.map(
        Array,
        function(item, cb) {
            _.bind(query, self, type + item, {}, cb)();
        },
        functionUtils.scrubArrayCallback(cb, wantArray)
    );
}

function metadataQuery(field, wantArray, ids, cb) {
    _.bind(query, this)(
        'metadata/' + field,
        {
            parameters: {
                id: ids.join(','),
            }
        },
        functionUtils.scrubArrayCallback(cb, wantArray)
    );
}

/** Object-oriented interface to the Classeur REST API. */
class ClasseurClient {
    /**
     * Constructs a new API client.
     * @param {string} userId - Classeur user ID string.
     * @param {string} apiKey - API Key string. Keep this secret.
     * @param {string} [host=app.classeur.io] - Fully qualified hostname to connect to. Connections will be made with HTTPS, regardless of whether the hostname is prefixed with `http://` or `https://`.
     */
    constructor(userId, apiKey, host) {
        host = host || 'app.classeur.io';
        this.RestClient = new RestClient({
            user: userId,
            password: apiKey,
        });
        host.replace(/\Ahttps?:[/][/]/g, '');
        this.root = `https://${host}/api/v1/`;
    }
};

module.exports = ClasseurClient;

Object.assign(
    module.exports.prototype,
    // Has to lend the prototype, otherwise the methods show up as static.
    /** @lends module:classeur-api-client~ClasseurClient */
    {
        /**
         * Retrieve one or more files.
         * @method
         * @instance
         * @access public
         * @param {String[]} &amp;#91;ids&amp;#93; - Array of Classeur file IDs to retrieve.
         * @param {module:classeur-api-client.ScrubbedCallback} callback - Called with `(error, result)`.
         * - `result` will be an Array of [File]{@link module:classeur-api-client.File}  objects, or `null` on error.
         *//**
         * Retrieve one or more files.
         * Like {@link ClasseurClient#getFiles}, but with spread: accepts a variable number of file IDs in the arguments, instead of an Array.
         * @method
         * @instance
         * @access public
         * @variation 2
         * @param {...String} &amp;hellip;ids - Classeur file IDs to retrieve.
         * @param {module:classeur-api-client.ScrubbedCallback} callback - Called with `(error, result)`.
         * - `result` will be an Array of [File]{@link module:classeur-api-client.File}  objects, or `null` on error.
         */
        getFiles: _.partial(functionUtils.restOrArrayAndCallback(multiQuery), 'files/', true),
        /**
         * Retrieve a single file.
         * @method
         * @instance
         * @access public
         * @param {String} id - Classeur file ID to retrieve.
         * @param {module:classeur-api-client.ScrubbedCallback} callback - Called with `(error, result)`.
         * - `result` will be a [File]{@link module:classeur-api-client.File} object, or `null` on error.
         */
        getFile: _.partial(functionUtils.singleElementAndCallback(multiQuery), 'files/', false),
        /**
         * Retrieve one or more folders.
         * @method
         * @instance
         * @access public
         * @param {String[]} &amp;#91;ids&amp;#93; - Array of Classeur folder IDs to retrieve.
         * @param {module:classeur-api-client.ScrubbedCallback} callback - Called with `(error, result)`.
         * - `result` will be an Array of [Folder]{@link module:classeur-api-client.Folder} objects, or `null` on error.
         *//**
         * Like {@link ClasseurClient#getFolders}, but with spread: accepts a variable number of folder IDs in the arguments, instead of an Array.
         * @method
         * @instance
         * @access public
         * @variation 2
         * @param {...String} &amp;hellip;ids - Classeur folder IDs to retrieve.
         * @param {module:classeur-api-client.ScrubbedCallback} callback - Called with `(error, result)`.
         * - `result` will be an Array of [Folder]{@link module:classeur-api-client.Folder} objects, or `null` on error.
         */
        getFolders: _.partial(functionUtils.restOrArrayAndCallback(multiQuery), 'folders/', true),
        /**
         * Retrieve a single folder.
         * @method
         * @instance
         * @access public
         * @param {String} id - Classeur folder ID to retrieve.
         * @param {module:classeur-api-client.ScrubbedCallback} callback - Called with `(error, result)`.
         * - `result` will be a [Folder]{@link module:classeur-api-client.Folder} object, or `null` on error.
         */
        getFolder: _.partial(functionUtils.singleElementAndCallback(multiQuery), 'folders/', false),
        /**
         * Retrieve all users on the Classeur account to which the ClasseurClient is connected.
         * @method
         * @instance
         * @access public
         * @param {module:classeur-api-client.ScrubbedCallback} callback - Called with `(error, result)`.
         * - `result` will be an Array of [User]{@link module:classeur-api-client.User} objects, or `null` on error.
         */
        getUsers: _.partial(functionUtils.singleElementAndCallback(multiQuery), 'users', true, ''),
        /**
         * Retrieve metadata for one or more users.
         * @method
         * @instance
         * @access public
         * @param {String[]} &amp;#91;ids&amp;#93; - Array of Classeur user IDs for which to retrieve metadata.
         * @param {module:classeur-api-client.ScrubbedCallback} callback - Called with `(error, result)`.
         * - `result` will be an Array of [UserMetadata]{@link module:classeur-api-client.UserMetadata} objects, or `null` on error.
         *//**
         * Like {@link ClasseurClient#getUsersMetadata}, but with spread: accepts a variable number of folder IDs in the arguments, instead of an Array.
         * @method
         * @instance
         * @access public
         * @variation 2
         * @param {...String} &amp;hellip;ids - Classeur user IDs for which to retrieve metadata.
         * @param [callback]{module:classeur-api-client.ScrubbedCallback} callback - Called with `(error, result)`.
         * - `result` will be an Array of [UserMetadata]{@link module:classeur-api-client.UserMetadata} objects, or `null` on error.
         */
        getUsersMetadata: _.partial(functionUtils.restOrArrayAndCallback(metadataQuery), 'users', true),
        /**
         * Retrieve metadata for one or more folders.
         * @method
         * @instance
         * @access public
         * @param {String[]} &amp;#91;ids&amp;#93; - Array of Classeur folder IDs for which to retrieve metadata.
         * @param {module:classeur-api-client.ScrubbedCallback} callback - Called with `(error, result)`.
         * - `result` will be an Array of [FolderMetadata]{@link module:classeur-api-client.FolderMetadata} objects, or `null` on error.
         *//**
         * Like {@link ClasseurClient#getUsersMetadata}, but with spread: accepts a variable number of folder IDs in the arguments, instead of an Array.
         * @method
         * @instance
         * @access public
         * @variation 2
         * @param {...String} &amp;hellip;ids - Classeur folder IDs for which to retrieve metadata.
         * @param {module:classeur-api-client.ScrubbedCallback} callback - Called with `(error, result)`.
         * - `result` will be an Array of [FolderMetadata]{@link module:classeur-api-client.FolderMetadata} objects, or `null` on error.
         */
        getFoldersMetadata: _.partial(functionUtils.restOrArrayAndCallback(metadataQuery), 'files', true),
        /**
         * Retrieve metadata for one or more files.
         * @method
         * @instance
         * @access public
         * @param {String[]} &amp;#91;ids&amp;#93; - Array of Classeur file IDs for which to retrieve metadata.
         * @param {module:classeur-api-client.ScrubbedCallback} callback - Called with `(error, result)`.
         * - `result` will be an Array of [FileMetadata]{@link module:classeur-api-client.FileMetadata} objects, or `null` on error.
         *//**
         * Like {@link ClasseurClient#getUsersMetadata}, but with spread: accepts a variable number of folder IDs in the arguments, instead of an Array.
         * @method
         * @instance
         * @access public
         * @variation 2
         * @param {...String} &amp;hellip;ids - Classeur file IDs for which to retrieve metadata.
         * @param {module:classeur-api-client.ScrubbedCallback} callback - Called with `(error, result)`.
         * - `result` will be an Array of [FileMetadata]{@link module:classeur-api-client.FileMetadata} objects, or `null` on error.
         */
        getFilesMetadata: _.partial(functionUtils.restOrArrayAndCallback(metadataQuery), 'folders', true),
        /**
         * Retrieve metadata for a user.
         * @method
         * @instance
         * @access public
         * @param {String} id - The Classeur user ID for which to retrieve metadata.
         * @param {module:classeur-api-client.ScrubbedCallback} callback - Called with `(error, result)`.
         * - `result` will be a [UserMetadata]{@link module:classeur-api-client.UserMetadata} object, or `null` on error.
         */
        getUserMetadata: _.partial(functionUtils.singleElementAndCallback(metadataQuery), 'users', false),
        /**
         * Retrieve metadata for a file.
         * @method
         * @instance
         * @access public
         * @param {String} id - The Classeur file ID for which to retrieve metadata.
         * @param {module:classeur-api-client.ScrubbedCallback} callback - Called with `(error, result)`.
         * - `result` will be a [FileMetadata]{@link module:classeur-api-client.FileMetadata} object, or `null` on error.
         */
        getFileMetadata: _.partial(functionUtils.singleElementAndCallback(metadataQuery), 'files', false),
        /**
         * Retrieve metadata for a folder.
         * @method
         * @instance
         * @access public
         * @param {String} id - The Classeur folder ID for which to retrieve metadata.
         * @param {module:classeur-api-client.ScrubbedCallback} callback - Called with `(error, result)`.
         * - `result` will be a [FolderMetadata]{@link module:classeur-api-client.FolderMetadata} object, or `null` on error.
         */
        getFolderMetadata: _.partial(functionUtils.singleElementAndCallback(metadataQuery), 'folders', false)
    }
);</pre>
    </article>
</section>





		</div>
	</div>

	<div class="clearfix"></div>

	

</div>
</div>

<div class="modal fade" id="searchResults">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">Search results</h4>
      </div>
      <div class="modal-body"></div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div>

<footer>


	<span class="copyright">
	Copyright Zac Bentley © 2015-2016
	</span>

<span class="jsdoc-message">
	Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a>
	
		on Wed Jan 13th 2016
	
	using the <a href="https://github.com/docstrap/docstrap">DocStrap template</a>.
</span>
</footer>

<script src="scripts/docstrap.lib.js"></script>
<script src="scripts/toc.js"></script>
<script type="text/javascript" src="scripts/fulltext-search-ui.js"></script>

<script>
$( function () {
	$( "[id*='$']" ).each( function () {
		var $this = $( this );

		$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
	} );

	$( ".tutorial-section pre, .readme-section pre" ).each( function () {
		var $this = $( this );

		var example = $this.find( "code" );
		exampleText = example.html();
		var lang = /{@lang (.*?)}/.exec( exampleText );
		if ( lang && lang[1] ) {
			exampleText = exampleText.replace( lang[0], "" );
			example.html( exampleText );
			lang = lang[1];
		} else {
			var langClassMatch = example.parent()[0].className.match(/lang\-(\S+)/);
			lang = langClassMatch ? langClassMatch[1] : "javascript";
		}

		if ( lang ) {

			$this
			.addClass( "sunlight-highlight-" + lang )
			.addClass( "linenums" )
			.html( example.html() );

		}
	} );

	Sunlight.highlightAll( {
		lineNumbers : true,
		showMenu : true,
		enableDoclinks : true
	} );

	$.catchAnchorLinks( {
        navbarOffset: 10
	} );
	$( "#toc" ).toc( {
		anchorName  : function ( i, heading, prefix ) {
			var id = $( heading ).attr( "id" );
			return id && id.replace(/\~/g, '-inner-').replace(/\./g, '-static-') || ( prefix + i );
		},
		selectors   : "#toc-content h1,#toc-content h2,#toc-content h3,#toc-content h4",
		showAndHide : false,
		smoothScrolling: true
	} );

	$( "#main span[id^='toc']" ).addClass( "toc-shim" );
	$( '.dropdown-toggle' ).dropdown();

    $( "table" ).each( function () {
      var $this = $( this );
      $this.addClass('table');
    } );

} );
</script>



<!--Navigation and Symbol Display-->


<!--Google Analytics-->


<script type="text/javascript">
	$(document).ready(function() {
		SearcherDisplay.init();
	});
</script>

</body>
</html>
